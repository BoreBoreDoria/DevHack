/**
 * @fileoverview added by tsickle
 * Generated from: lib/directives/http.directive.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { __read, __spread } from "tslib";
import { HttpClient } from '@angular/common/http';
import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';
import { of } from 'rxjs';
import { catchError } from 'rxjs/operators';
/** @enum {string} */
var HttpStrategies = {
    DELETE: "delete",
    GET: "get",
    HEAD: "head",
    JSONP: "jsonp",
    OPTIONS: "options",
    PATCH: "patch",
    POST: "post",
    PUT: "put",
};
/**
 * @record
 */
function HttpContext() { }
if (false) {
    /** @type {?} */
    HttpContext.prototype.$implicit;
    /** @type {?} */
    HttpContext.prototype.data;
}
/**
 * @record
 */
function HttpStrategy() { }
if (false) {
    /** @type {?} */
    HttpStrategy.prototype.type;
    /** @type {?} */
    HttpStrategy.prototype.changes;
    /** @type {?} */
    HttpStrategy.prototype.require;
}
/** @type {?} */
var HTTP_CONFIG = [
    {
        type: HttpStrategies.DELETE,
        changes: ['httpDelete', 'httpWith'],
        require: ['httpDelete']
    },
    {
        type: HttpStrategies.GET,
        changes: ['httpGet', 'httpWith'],
        require: ['httpGet']
    },
    {
        type: HttpStrategies.HEAD,
        changes: ['httpHead', 'httpWith'],
        require: ['httpHead']
    },
    {
        type: HttpStrategies.JSONP,
        changes: ['httpJsonp', 'httpCallback'],
        require: ['httpJsonp', 'httpCallback']
    },
    {
        type: HttpStrategies.OPTIONS,
        changes: ['httpOptions', 'httpWith'],
        require: ['httpOptions']
    },
    {
        type: HttpStrategies.PATCH,
        changes: ['httpPatch', 'httpSend', 'httpWith'],
        require: ['httpPatch']
    },
    {
        type: HttpStrategies.POST,
        changes: ['httpPost', 'httpSend', 'httpWith'],
        require: ['httpPost']
    },
    {
        type: HttpStrategies.PUT,
        changes: ['httpPut', 'httpSend', 'httpWith'],
        require: ['httpPut']
    }
];
var HttpDirective = /** @class */ (function () {
    function HttpDirective(http, templateRef, viewContainerRef) {
        this.http = http;
        this.templateRef = templateRef;
        this.viewContainerRef = viewContainerRef;
        this.context = {
            $implicit: null,
            /**
             * @return {?}
             */
            get data() { return this.$implicit; }
        };
        this.viewRef = this.viewContainerRef.createEmbeddedView(this.templateRef, this.context);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    HttpDirective.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        /** @type {?} */
        var strategy = this.findStrategy(changes);
        if (strategy) {
            this.execute(strategy);
        }
    };
    /**
     * @return {?}
     */
    HttpDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.dispose();
        this.viewContainerRef.clear();
        if (this.viewRef) {
            this.viewRef.destroy();
            this.viewRef = null;
        }
    };
    /**
     * @private
     * @param {?} changes
     * @return {?}
     */
    HttpDirective.prototype.findStrategy = /**
     * @private
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        return HTTP_CONFIG.find((/**
         * @param {?} strategy
         * @return {?}
         */
        function (strategy) {
            return strategy.changes.some((/**
             * @param {?} field
             * @return {?}
             */
            function (field) { return !!changes[field]; }))
                && strategy.require.every((/**
                 * @param {?} field
                 * @return {?}
                 */
                function (field) { return !!_this[field]; }));
        }));
    };
    /**
     * @private
     * @param {?} strategy
     * @return {?}
     */
    HttpDirective.prototype.execute = /**
     * @private
     * @param {?} strategy
     * @return {?}
     */
    function (strategy) {
        var _this = this;
        /** @type {?} */
        var params = strategy.changes.map((/**
         * @param {?} field
         * @return {?}
         */
        function (field) { return _this[field]; }));
        this.request.apply(this, __spread([strategy.type], params));
    };
    /**
     * @private
     * @param {?} method
     * @param {...?} params
     * @return {?}
     */
    HttpDirective.prototype.request = /**
     * @private
     * @param {?} method
     * @param {...?} params
     * @return {?}
     */
    function (method) {
        var _a;
        var _this = this;
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        this.dispose();
        this.subscription = (_a = this.http)[method].apply(_a, __spread(params)).pipe(catchError((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            console.error(e);
            return of(null);
        })))
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.context.$implicit = data;
            _this.viewRef.markForCheck();
        }));
    };
    /**
     * @private
     * @return {?}
     */
    HttpDirective.prototype.dispose = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.subscription && !this.subscription.closed) {
            this.subscription.unsubscribe();
            this.subscription = null;
        }
    };
    HttpDirective.decorators = [
        { type: Directive, args: [{ selector: '[http]' },] }
    ];
    /** @nocollapse */
    HttpDirective.ctorParameters = function () { return [
        { type: HttpClient },
        { type: TemplateRef },
        { type: ViewContainerRef }
    ]; };
    HttpDirective.propDecorators = {
        httpDelete: [{ type: Input }],
        httpGet: [{ type: Input }],
        httpHead: [{ type: Input }],
        httpJsonp: [{ type: Input }],
        httpOptions: [{ type: Input }],
        httpPatch: [{ type: Input }],
        httpPost: [{ type: Input }],
        httpPut: [{ type: Input }],
        httpSend: [{ type: Input }],
        httpCallback: [{ type: Input }],
        httpWith: [{ type: Input }]
    };
    return HttpDirective;
}());
export { HttpDirective };
if (false) {
    /** @type {?} */
    HttpDirective.prototype.httpDelete;
    /** @type {?} */
    HttpDirective.prototype.httpGet;
    /** @type {?} */
    HttpDirective.prototype.httpHead;
    /** @type {?} */
    HttpDirective.prototype.httpJsonp;
    /** @type {?} */
    HttpDirective.prototype.httpOptions;
    /** @type {?} */
    HttpDirective.prototype.httpPatch;
    /** @type {?} */
    HttpDirective.prototype.httpPost;
    /** @type {?} */
    HttpDirective.prototype.httpPut;
    /** @type {?} */
    HttpDirective.prototype.httpSend;
    /** @type {?} */
    HttpDirective.prototype.httpCallback;
    /** @type {?} */
    HttpDirective.prototype.httpWith;
    /**
     * @type {?}
     * @private
     */
    HttpDirective.prototype.context;
    /**
     * @type {?}
     * @private
     */
    HttpDirective.prototype.viewRef;
    /**
     * @type {?}
     * @private
     */
    HttpDirective.prototype.subscription;
    /**
     * @type {?}
     * @private
     */
    HttpDirective.prototype.http;
    /**
     * @type {?}
     * @private
     */
    HttpDirective.prototype.templateRef;
    /**
     * @type {?}
     * @private
     */
    HttpDirective.prototype.viewContainerRef;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Abmd4Zi9wbGF0Zm9ybS8iLCJzb3VyY2VzIjpbImxpYi9kaXJlY3RpdmVzL2h0dHAuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsU0FBUyxFQUFtQixLQUFLLEVBQXVDLFdBQVcsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN0SSxPQUFPLEVBQUUsRUFBRSxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUN4QyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7O0FBRTVDLElBQUssY0FBYztJQUNqQixNQUFNLFVBQVc7SUFDakIsR0FBRyxPQUFRO0lBQ1gsSUFBSSxRQUFTO0lBQ2IsS0FBSyxTQUFVO0lBQ2YsT0FBTyxXQUFZO0lBQ25CLEtBQUssU0FBVTtJQUNmLElBQUksUUFBUztJQUNiLEdBQUcsT0FBUTtFQUNaOzs7O0FBRUQsMEJBR0M7OztJQUZDLGdDQUFlOztJQUNmLDJCQUFVOzs7OztBQUdaLDJCQUlDOzs7SUFIQyw0QkFBcUI7O0lBQ3JCLCtCQUFrQjs7SUFDbEIsK0JBQWtCOzs7SUFHZCxXQUFXLEdBQW1CO0lBQ2xDO1FBQ0UsSUFBSSxFQUFFLGNBQWMsQ0FBQyxNQUFNO1FBQzNCLE9BQU8sRUFBRSxDQUFFLFlBQVksRUFBRSxVQUFVLENBQUU7UUFDckMsT0FBTyxFQUFFLENBQUUsWUFBWSxDQUFFO0tBQzFCO0lBQ0Q7UUFDRSxJQUFJLEVBQUUsY0FBYyxDQUFDLEdBQUc7UUFDeEIsT0FBTyxFQUFFLENBQUUsU0FBUyxFQUFFLFVBQVUsQ0FBRTtRQUNsQyxPQUFPLEVBQUUsQ0FBRSxTQUFTLENBQUU7S0FDdkI7SUFDRDtRQUNFLElBQUksRUFBRSxjQUFjLENBQUMsSUFBSTtRQUN6QixPQUFPLEVBQUUsQ0FBRSxVQUFV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O2dCQUM4RCxXQUFXO2dCQUFFLGdCQUFnQjs7OzZCQXdFM0csS0FBSzswQkFDTCxLQUFLOzJCQUNMLEtBQUs7NEJBQ0wsS0FBSzs4QkFDTCxLQUFLOzRCQUNMLEtBQUs7MkJBQ0wsS0FBSzswQkFDTCxLQUFLOzJCQUVMLEtBQUs7K0JBQ0wsS0FBSzsyQkFDTCxLQUFLOztJQWtFUixvQkFBQztDQUFBLEFBaEZELElBZ0ZDO1NBL0VZLGFBQWE7OztJQUV4QixtQ0FBNEI7O0lBQzVCLGdDQUF5Qjs7SUFDekIsaUNBQTBCOztJQUMxQixrQ0FBMkI7O0lBQzNCLG9DQUE2Qjs7SUFDN0Isa0NBQTJCOztJQUMzQixpQ0FBMEI7O0lBQzFCLGdDQUF5Qjs7SUFFekIsaUNBQXVCOztJQUN2QixxQ0FBOEI7O0lBQzlCLGlDQUF1Qjs7Ozs7SUFFdkIsZ0NBR0U7Ozs7O0lBRUYsZ0NBQzJFOzs7OztJQUUzRSxxQ0FBbUM7Ozs7O0lBR2pDLDZCQUF3Qjs7Ozs7SUFDeEIsb0NBQTZDOzs7OztJQUM3Qyx5Q0FBMEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgRGlyZWN0aXZlLCBFbWJlZGRlZFZpZXdSZWYsIElucHV0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSwgU2ltcGxlQ2hhbmdlcywgVGVtcGxhdGVSZWYsIFZpZXdDb250YWluZXJSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IG9mLCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGNhdGNoRXJyb3IgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmVudW0gSHR0cFN0cmF0ZWdpZXMge1xuICBERUxFVEUgPSAnZGVsZXRlJyxcbiAgR0VUID0gJ2dldCcsXG4gIEhFQUQgPSAnaGVhZCcsXG4gIEpTT05QID0gJ2pzb25wJyxcbiAgT1BUSU9OUyA9ICdvcHRpb25zJyxcbiAgUEFUQ0ggPSAncGF0Y2gnLFxuICBQT1NUID0gJ3Bvc3QnLFxuICBQVVQgPSAncHV0J1xufVxuXG5pbnRlcmZhY2UgSHR0cENvbnRleHQge1xuICAkaW1wbGljaXQ6IGFueTtcbiAgZGF0YTogYW55O1xufVxuXG5pbnRlcmZhY2UgSHR0cFN0cmF0ZWd5IHtcbiAgdHlwZTogSHR0cFN0cmF0ZWdpZXM7XG4gIGNoYW5nZXM6IHN0cmluZ1tdO1xuICByZXF1aXJlOiBzdHJpbmdbXTtcbn1cblxuY29uc3QgSFRUUF9DT05GSUc6IEh0dHBTdHJhdGVneVtdID0gW1xuICB7XG4gICAgdHlwZTogSHR0cFN0cmF0ZWdpZXMuREVMRVRFLFxuICAgIGNoYW5nZXM6IFsgJ2h0dHBEZWxldGUnLCAnaHR0cFdpdGgnIF0sXG4gICAgcmVxdWlyZTogWyAnaHR0cERlbGV0ZScgXVxuICB9LFxuICB7XG4gICAgdHlwZTogSHR0cFN0cmF0ZWdpZXMuR0VULFxuICAgIGNoYW5nZXM6IFsgJ2h0dHBHZXQnLCAnaHR0cFdpdGgnIF0sXG4gICAgcmVxdWlyZTogWyAnaHR0cEdldCcgXVxuICB9LFxuICB7XG4gICAgdHlwZTogSHR0cFN0cmF0ZWdpZXMuSEVBRCxcbiAgICBjaGFuZ2VzOiBbICdodHRwSGVhZCcsICdodHRwV2l0aCcgXSxcbiAgICByZXF1aXJlOiBbICdodHRwSGVhZCcgXVxuICB9LFxuICB7XG4gICAgdHlwZTogSHR0cFN0cmF0ZWdpZXMuSlNPTlAsXG4gICAgY2hhbmdlczogWyAnaHR0cEpzb25wJywgJ2h0dHBDYWxsYmFjaycgXSxcbiAgICByZXF1aXJlOiBbICdodHRwSnNvbnAnLCAnaHR0cENhbGxiYWNrJyBdXG4gIH0sXG4gIHtcbiAgICB0eXBlOiBIdHRwU3RyYXRlZ2llcy5PUFRJT05TLFxuICAgIGNoYW5nZXM6IFsgJ2h0dHBPcHRpb25zJywgJ2h0dHBXaXRoJyBdLFxuICAgIHJlcXVpcmU6IFsgJ2h0dHBPcHRpb25zJyBdXG4gIH0sXG4gIHtcbiAgICB0eXBlOiBIdHRwU3RyYXRlZ2llcy5QQVRDSCxcbiAgICBjaGFuZ2VzOiBbICdodHRwUGF0Y2gnLCAnaHR0cFNlbmQnLCAnaHR0cFdpdGgnIF0sXG4gICAgcmVxdWlyZTogWyAnaHR0cFBhdGNoJyBdXG4gIH0sXG4gIHtcbiAgICB0eXBlOiBIdHRwU3RyYXRlZ2llcy5QT1NULFxuICAgIGNoYW5nZXM6IFsgJ2h0dHBQb3N0JywgJ2h0dHBTZW5kJywgJ2h0dHBXaXRoJyBdLFxuICAgIHJlcXVpcmU6IFsgJ2h0dHBQb3N0JyBdXG4gIH0sXG4gIHtcbiAgICB0eXBlOiBIdHRwU3RyYXRlZ2llcy5QVVQsXG4gICAgY2hhbmdlczogWyAnaHR0cFB1dCcsICdodHRwU2VuZCcsICdodHRwV2l0aCcgXSxcbiAgICByZXF1aXJlOiBbICdodHRwUHV0JyBdXG4gIH1cbl07XG5cbkBEaXJlY3RpdmUoeyBzZWxlY3RvcjogJ1todHRwXScgfSlcbmV4cG9ydCBjbGFzcyBIdHRwRGlyZWN0aXZlIGltcGxlbWVudHMgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xuXG4gIEBJbnB1dCgpIGh0dHBEZWxldGU6IHN0cmluZztcbiAgQElucHV0KCkgaHR0cEdldDogc3RyaW5nO1xuICBASW5wdXQoKSBodHRwSGVhZDogc3RyaW5nO1xuICBASW5wdXQoKSBodHRwSnNvbnA6IHN0cmluZztcbiAgQElucHV0KCkgaHR0cE9wdGlvbnM6IHN0cmluZztcbiAgQElucHV0KCkgaHR0cFBhdGNoOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGh0dHBQb3N0OiBzdHJpbmc7XG4gIEBJbnB1dCgpIGh0dHBQdXQ6IHN0cmluZztcblxuICBASW5wdXQoKSBodHRwU2VuZDogYW55O1xuICBASW5wdXQoKSBodHRwQ2FsbGJhY2s6IHN0cmluZztcbiAgQElucHV0KCkgaHR0cFdpdGg6IGFueTtcblxuICBwcml2YXRlIGNvbnRleHQ6IEh0dHBDb250ZXh0ID0ge1xuICAgICRpbXBsaWNpdDogbnVsbCxcbiAgICBnZXQgZGF0YSgpIHsgcmV0dXJuIHRoaXMuJGltcGxpY2l0OyB9XG4gIH07XG5cbiAgcHJpdmF0ZSB2aWV3UmVmOiBFbWJlZGRlZFZpZXdSZWY8SHR0cENvbnRleHQ+ID1cbiAgICB0aGlzLnZpZXdDb250YWluZXJSZWYuY3JlYXRlRW1iZWRkZWRWaWV3KHRoaXMudGVtcGxhdGVSZWYsIHRoaXMuY29udGV4dCk7XG5cbiAgcHJpdmF0ZSBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQsXG4gICAgcHJpdmF0ZSB0ZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8SHR0cENvbnRleHQ+LFxuICAgIHByaXZhdGUgdmlld0NvbnRhaW5lclJlZjogVmlld0NvbnRhaW5lclJlZlxuICApIHt9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGNvbnN0IHN0cmF0ZWd5OiBIdHRwU3RyYXRlZ3kgPSB0aGlzLmZpbmRTdHJhdGVneShjaGFuZ2VzKTtcbiAgICBpZiAoc3RyYXRlZ3kpIHtcbiAgICAgIHRoaXMuZXhlY3V0ZShzdHJhdGVneSk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5kaXNwb3NlKCk7XG4gICAgdGhpcy52aWV3Q29udGFpbmVyUmVmLmNsZWFyKCk7XG4gICAgaWYgKHRoaXMudmlld1JlZikge1xuICAgICAgdGhpcy52aWV3UmVmLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMudmlld1JlZiA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmaW5kU3RyYXRlZ3koY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IEh0dHBTdHJhdGVneSB7XG4gICAgcmV0dXJuIEhUVFBfQ09ORklHLmZpbmQoKHN0cmF0ZWd5KSA9PiB7XG4gICAgICByZXR1cm4gc3RyYXRlZ3kuY2hhbmdlcy5zb21lKGZpZWxkID0+ICEhY2hhbmdlc1sgZmllbGQgXSlcbiAgICAgICAgJiYgc3RyYXRlZ3kucmVxdWlyZS5ldmVyeShmaWVsZCA9PiAhIXRoaXNbIGZpZWxkIF0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBleGVjdXRlKHN0cmF0ZWd5OiBIdHRwU3RyYXRlZ3kpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBzdHJhdGVneS5jaGFuZ2VzLm1hcChmaWVsZCA9PiB0aGlzWyBmaWVsZCBdKTtcblxuICAgIHRoaXMucmVxdWVzdChzdHJhdGVneS50eXBlLCAuLi5wYXJhbXMpO1xuICB9XG5cbiAgcHJpdmF0ZSByZXF1ZXN0KG1ldGhvZCwgLi4ucGFyYW1zKSB7XG4gICAgdGhpcy5kaXNwb3NlKCk7XG4gICAgdGhpcy5zdWJzY3JpcHRpb24gPSB0aGlzLmh0dHBbIG1ldGhvZCBdKC4uLnBhcmFtcylcbiAgICAgIC5waXBlKGNhdGNoRXJyb3IoKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgcmV0dXJuIG9mKG51bGwpO1xuICAgICAgfSkpXG4gICAgICAuc3Vic2NyaWJlKChkYXRhKSA9PiB7XG4gICAgICAgIHRoaXMuY29udGV4dC4kaW1wbGljaXQgPSBkYXRhO1xuICAgICAgICB0aGlzLnZpZXdSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgZGlzcG9zZSgpIHtcbiAgICBpZiAodGhpcy5zdWJzY3JpcHRpb24gJiYgIXRoaXMuc3Vic2NyaXB0aW9uLmNsb3NlZCkge1xuICAgICAgdGhpcy5zdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICB9XG4gIH1cbn1cbiJdfQ==